{"openapi":"3.0.0","paths":{"/api/script/{id}/revisions":{"get":{"operationId":"revisionList","summary":"","description":"Get a list of revisions (bundle not included).","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}},{"name":"page","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/PaginatedResponseDto"},{"properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/RevisionDataDto"}}}}]}}}}},"tags":["scripts"],"security":[{"bearer":[]}]},"patch":{"operationId":"setRevision","summary":"","description":"Set the current active revision for a script.","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}},{"name":"revisionId","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewRevisionResponseDto"}}}}},"tags":["scripts"],"security":[{"bearer":[]}]},"put":{"operationId":"createRevision","summary":"","description":"Create a new revision.","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateRevisionDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RevisionDataDto"}}}}},"tags":["scripts"],"security":[{"bearer":[]}]}},"/api/script/{id}":{"get":{"operationId":"getScript","summary":"","description":"Get a script by ID.","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScriptDto"}}}}},"tags":["scripts"],"security":[{"bearer":[]}]},"delete":{"operationId":"deleteScript","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}}},"tags":["scripts"],"security":[{"bearer":[]}]}},"/api/project/{project}/scripts":{"get":{"operationId":"listScripts","summary":"","description":"Get a paginated list of scripts.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}},{"name":"page","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/PaginatedResponseDto"},{"properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/ScriptDto"}}}}]}}}}},"tags":["scripts"],"security":[{"bearer":[]}]},"post":{"operationId":"createScript","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateScriptDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScriptDto"}}}}},"tags":["scripts"],"security":[{"bearer":[]}]}},"/api/revisions/{id}":{"get":{"operationId":"getRevision","summary":"","description":"Get a revision by ID.","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}},{"name":"withBundle","required":true,"in":"query","schema":{"type":"boolean"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RevisionFullDto"}}}}},"tags":["revisions"],"security":[{"bearer":[]}]},"delete":{"operationId":"deleteRevision","summary":"","description":"Delete a revision by ID.","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewRevisionResponseDto"}}}}},"tags":["revisions"],"security":[{"bearer":[]}]}},"/api/auth/login":{"post":{"operationId":"login","summary":"","description":"Login with username/password and recieve an authentication token.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthTokenDto"}}}}},"tags":["auth"]}},"/api/users":{"post":{"operationId":"createUser","summary":"","description":"Create a new user using standard username/password sign up.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}},"tags":["users"]},"get":{"operationId":"searchUsers","parameters":[{"name":"name","required":true,"in":"query","schema":{"type":"string"}},{"name":"page","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/PaginatedResponseDto"},{"properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/UserDto"}}}}]}}}}},"tags":["users"],"security":[{"bearer":[]}]}},"/api/users/@me":{"get":{"operationId":"me","summary":"","description":"Get the currently logged in user's details.","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}},"tags":["users"],"security":[{"bearer":[]}]}},"/api/project/{project}/acl/@me":{"get":{"operationId":"getAclMe","summary":"","description":"Get ACL list for the current authorized user.\nThis doesn't require the `PERMISSIONS_READ` permission.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AclListDto"}}}}},"tags":["acl"]}},"/api/project/{project}/acl/{user}":{"get":{"operationId":"getAclSingle","summary":"","description":"Get ACL list for a single user.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}},{"name":"user","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AclListDto"}}}}},"tags":["acl"]},"put":{"operationId":"putAcl","summary":"","description":"Set ACL access for the project for the user.\nThis will implicitly add the user to the project.\nIf `permissions` is empty then the user will be removed from the project.","parameters":[{"name":"user","required":true,"in":"path","schema":{"type":"string"}},{"name":"project","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"array","items":{"type":"string"}}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AclListDto"}}}}},"tags":["acl"]}},"/api/project/{project}/acl":{"get":{"operationId":"getAcl","summary":"","description":"Get ACL list for all users.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AclListDto"}}}}}},"tags":["acl"]}},"/api/acl/permissions":{"get":{"operationId":"getPermissions","summary":"","description":"Get a list of all permissions.","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"type":"string"}}}}}},"tags":["acl"]}},"/api/project":{"post":{"operationId":"createProject","summary":"","description":"Create a project and return the data.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateProjectDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectDto"}}}}},"tags":["project"],"security":[{"bearer":[]}]},"get":{"operationId":"listProjects","summary":"","description":"Get projects that a user has access to.","parameters":[{"name":"page","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/PaginatedResponseDto"},{"properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/ProjectDto"}}}}]}}}}},"tags":["project"],"security":[{"bearer":[]}]}},"/api/project/{project}":{"get":{"operationId":"getProject","summary":"","description":"Get a project by its ID.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectDto"}}}}},"tags":["project"],"security":[{"bearer":[]}]},"delete":{"operationId":"deleteProject","summary":"","description":"Delete a project by its ID.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}}},"tags":["project"],"security":[{"bearer":[]}]}},"/api/project/{project}/kv":{"get":{"operationId":"listNamespaces","summary":"","description":"List all namespaces in a project.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/NamespaceDto"}}}}}},"tags":["kv"],"security":[{"bearer":[]}]}},"/api/project/{project}/kv/{namespace}":{"delete":{"operationId":"deleteNamespace","summary":"","description":"Delete a namespace and all keys in a project.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}},{"name":"namespace","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}}},"tags":["kv"],"security":[{"bearer":[]}]},"get":{"operationId":"listNamespace","summary":"","description":"List pairs in a namespace.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}},{"name":"namespace","required":true,"in":"path","schema":{"type":"string"}},{"name":"token","required":false,"in":"query","description":"Pagination token","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ListNamespaceDto"}}}}},"tags":["kv"],"security":[{"bearer":[]}]}},"/api/project/{project}/kv/{namespace}/{key}":{"get":{"operationId":"getKey","summary":"","description":"Get a value from a key in a namespace.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}},{"name":"namespace","required":true,"in":"path","schema":{"type":"string"}},{"name":"key","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PairDto"}}}}},"tags":["kv"],"security":[{"bearer":[]}]},"delete":{"operationId":"deleteKey","summary":"","description":"Delete a value from a key in a namespace.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}},{"name":"namespace","required":true,"in":"path","schema":{"type":"string"}},{"name":"key","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}}},"tags":["kv"],"security":[{"bearer":[]}]},"put":{"operationId":"setKey","summary":"","description":"Create or update a value from a key in a namespace.","parameters":[{"name":"project","required":true,"in":"path","schema":{"type":"string"}},{"name":"namespace","required":true,"in":"path","schema":{"type":"string"}},{"name":"key","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetKeyDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}}},"tags":["kv"],"security":[{"bearer":[]}]}}},"info":{"title":"Actias API","description":"Public facing API for Actias workers.","version":"1.0","contact":{}},"tags":[{"name":"scripts","description":"revisions"}],"servers":[],"components":{"securitySchemes":{"bearer":{"scheme":"bearer","bearerFormat":"JWT","type":"http"}},"schemas":{"PaginatedResponseDto":{"type":"object","properties":{"page":{"type":"number","description":"Current page."},"lastPage":{"type":"number","description":"Last possible page."}},"required":["page","lastPage"]},"ScriptConfigDto":{"type":"object","properties":{"id":{"type":"string"},"entryPoint":{"type":"string"},"ignore":{"type":"array","items":{"type":"string"}},"includes":{"type":"array","items":{"type":"string"}}},"required":["id","entryPoint","ignore","includes"]},"RevisionDataDto":{"type":"object","properties":{"id":{"type":"string"},"created":{"format":"date-time","type":"string","description":"Date that revision was published."},"scriptId":{"type":"string","description":"ID of the script this revision is attached to."},"scriptConfig":{"description":"Config that the project was uploaded with.\nThis is metadata and is mostly included for CLI to restore revisions intact.","allOf":[{"$ref":"#/components/schemas/ScriptConfigDto"}]}},"required":["id","created","scriptId","scriptConfig"]},"NewRevisionResponseDto":{"type":"object","properties":{"scriptId":{"type":"string"},"revisionId":{"type":"string","description":"New revision ID.\nThis may be null."}},"required":["scriptId"]},"FileDto":{"type":"object","properties":{"revisionId":{"type":"string","description":"ID of the revision this file resides in.\nThis is empty when creating a revision or uploading a bundle."},"fileName":{"type":"string","description":"Name of the file"},"filePath":{"type":"string","description":"Path of file relative from the root path"},"content":{"type":"string","description":"Content of the file, base64 encoded"}},"required":["fileName","filePath","content"]},"BundleDto":{"type":"object","properties":{"entryPoint":{"type":"string","description":"Path of the entrypoint file.\nThis is the first file which is executed by the runtime."},"files":{"description":"All files within the bundle.","type":"array","items":{"$ref":"#/components/schemas/FileDto"}}},"required":["entryPoint","files"]},"CreateRevisionDto":{"type":"object","properties":{"bundle":{"description":"The bundle which will be used.","allOf":[{"$ref":"#/components/schemas/BundleDto"}]},"scriptConfig":{"type":"object","description":"A valid project configuration."}},"required":["bundle","scriptConfig"]},"ScriptDto":{"type":"object","properties":{"id":{"type":"string"},"publicIdentifier":{"type":"string","description":"Public identifier of the script.\nThis must be globally unique"},"lastUpdated":{"format":"date-time","type":"string","description":"Date that the script (or revisions) were last updated."},"currentRevisionId":{"type":"string","description":"ID of the currently deployed revision.\nThis is empty for newly created scripts."},"projectId":{"type":"string","description":"Parent project that owns this script."}},"required":["id","publicIdentifier","lastUpdated","projectId"]},"MessageResponseDto":{"type":"object","properties":{"message":{"type":"string","description":"Message for the response"}},"required":["message"]},"CreateScriptDto":{"type":"object","properties":{"publicIdentifier":{"type":"string","description":"Public identifier of the script.\nThis will be the globally unique identifier of your script.","minLength":3,"maxLength":63}},"required":["publicIdentifier"]},"RevisionFullDto":{"type":"object","properties":{"id":{"type":"string"},"created":{"format":"date-time","type":"string","description":"Date that revision was published."},"scriptId":{"type":"string","description":"ID of the script this revision is attached to."},"scriptConfig":{"description":"Config that the project was uploaded with.\nThis is metadata and is mostly included for CLI to restore revisions intact.","allOf":[{"$ref":"#/components/schemas/ScriptConfigDto"}]},"bundle":{"description":"Content bundle of all files.\nThis is only present in some responses.","allOf":[{"$ref":"#/components/schemas/BundleDto"}]}},"required":["id","created","scriptId","scriptConfig"]},"LoginDto":{"type":"object","properties":{"auth":{"type":"string","description":"Either username or email."},"password":{"type":"string"}},"required":["auth","password"]},"AuthTokenDto":{"type":"object","properties":{"token":{"type":"string"}},"required":["token"]},"CreateUserDto":{"type":"object","properties":{"username":{"type":"string","description":"Username, must be unique.","minLength":6,"maxLength":36},"email":{"type":"string"},"password":{"type":"string","description":"Password between 8 and 64 characters.","minLength":8,"maxLength":64}},"required":["username","email","password"]},"UserDto":{"type":"object","properties":{"id":{"type":"string","description":"Users ID."},"created":{"format":"date-time","type":"string","description":"When the user was created."},"admin":{"type":"boolean","description":"If the user is a system admin."},"email":{"type":"string","description":"Users email."},"username":{"type":"string","description":"Users username."}},"required":["id","created","email","username"]},"AclListDto":{"type":"object","properties":{"user":{"description":"User id that the permissions apply to.","allOf":[{"$ref":"#/components/schemas/UserDto"}]},"permissions":{"type":"object","description":"List of permissions"}},"required":["user","permissions"]},"CreateProjectDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of project.","minLength":6,"maxLength":36}},"required":["name"]},"ProjectDto":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string","description":"Name of project."},"ownerId":{"type":"string","description":"Owner of project, has full access."},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","name","ownerId","createdAt","updatedAt"]},"NamespaceDto":{"type":"object","properties":{"projectId":{"type":"string"},"name":{"type":"string","description":"Namespace identifier (project scoped)"},"count":{"type":"number","description":"Amount of pairs in the namespace."}},"required":["projectId","name","count"]},"PairDto":{"type":"object","properties":{"type":{"type":"number","enum":[0,1,2,3,4]},"projectId":{"type":"string"},"namespace":{"type":"string"},"ttl":{"type":"number"},"key":{"type":"string"},"value":{"type":"string"}},"required":["type","projectId","namespace","ttl","key","value"]},"ListNamespaceDto":{"type":"object","properties":{"pageSize":{"type":"number"},"token":{"type":"string","description":"Token used to fetch next page.\nNot provided on last page."},"pairs":{"type":"array","items":{"$ref":"#/components/schemas/PairDto"}}},"required":["pageSize","pairs"]},"SetKeyDto":{"type":"object","properties":{"type":{"type":"string"},"value":{"type":"string"}},"required":["type","value"]}}}}